image: Visual Studio 2022

environment:
  JAVA_HOME: "C:\\Program Files\\Java\\jdk-11.0.28"
  PATH: "%JAVA_HOME%\\bin;%PATH%"

branches:
  only:
    - master

# Переключаем AppVeyor с MSBuild на скриптовый режим
build:
  mode: Script

install:
  # Запускаем сервер в фоне
  - start /B java -jar ./artifacts/app-order.jar
  # Ждем, чтобы сервер успел подняться (5 секунд)
  - timeout /t 5 /nobreak

build_script:
  - echo "Запуск тестов через Gradle"
  - .\gradlew.bat test -Dselenide.headless=true --info
